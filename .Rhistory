setwd("D:/People/Bryson/PhosphateAnalysis")
library(corrplot)
library(ggplot2)
library(dplyr)
library(psych) # for describeby
library(car) #for leven's test
library(flextable)
# devtools::install_github("davidgohel/officedown")
library(officedown)
source('Scripts/Phos_Load_and_Preprocess.R')
source('Scripts/Phos_Alpha_vs_RMSD.R')
source('Scripts/Phos_Alpha_vs_RMSD.R')
rmarkdown::render(input = 'Scripts/Phos_Top5Bottom5_Tables.rmd',
output_file = paste0('TopAndBottom_Tables_',format(Sys.time(), '%Y%m%d'),'.docx'),
output_dir = 'Analysis/')
source('Scripts/Phos_Alpha_vs_RMSD.R')
source('Scripts/Phos_Alpha_vs_RMSD.R')
rmarkdown::render(input = 'Scripts/Phos_Top5Bottom5_Tables.rmd',
output_file = paste0('TopAndBottom_Tables_',format(Sys.time(), '%Y%m%d'),'.docx'),
output_dir = 'Analysis/')
hit_analysis %>%
ungroup() %>%
mutate(nl = factor(hit_analysis$nl, levels = sort(unique(hit_analysis$nl)))) %>%
# pivot_wider(names_from = nl, values_from = n) %>%
ggplot(aes(x = nl, y = Nl_Ranking, fill = n)) +
geom_tile() +
theme_bw() +
theme(axis.text.x = element_text(angle = 45)) +
facet_wrap(~drug_grouping) +
scale_colour_viridis_d()
hit_analysis <- df %>%
mutate(nl =   apply(df[c("n.1.", "n.2.", "n.3.", "n.4.")], 1, paste,collapse="")) %>%
filter(ATOM == 'P') %>%
group_by(drug, compound, alphavalue) %>%
arrange(RMSD_MAP) %>%
slice(1:5) %>%
mutate(Nl_Ranking = row_number()) %>%
mutate(drug_grouping = str_sub(drug,-3,-1)) %>%
mutate(drug_grouping = replace(drug_grouping, drug_grouping=='ide','ate')) %>%
mutate(drug_grouping = replace(drug_grouping, drug_grouping=='ine','ite')) %>%
filter(alphavalue < 3.6) %>%
ungroup() %>%
select(nl, Nl_Ranking, drug_grouping) %>%
group_by(nl, Nl_Ranking, drug_grouping) %>%
summarise(n = n()) %>%
arrange(Nl_Ranking, desc(n))
hit_analysis %>%
ungroup() %>%
mutate(nl = factor(hit_analysis$nl, levels = sort(unique(hit_analysis$nl)))) %>%
# pivot_wider(names_from = nl, values_from = n) %>%
ggplot(aes(x = nl, y = Nl_Ranking, fill = n)) +
geom_tile() +
theme_bw() +
theme(axis.text.x = element_text(angle = 45)) +
facet_wrap(~drug_grouping) +
scale_colour_viridis_d()
library(stringr)
hit_analysis <- df %>%
mutate(nl =   apply(df[c("n.1.", "n.2.", "n.3.", "n.4.")], 1, paste,collapse="")) %>%
filter(ATOM == 'P') %>%
group_by(drug, compound, alphavalue) %>%
arrange(RMSD_MAP) %>%
slice(1:5) %>%
mutate(Nl_Ranking = row_number()) %>%
mutate(drug_grouping = str_sub(drug,-3,-1)) %>%
mutate(drug_grouping = replace(drug_grouping, drug_grouping=='ide','ate')) %>%
mutate(drug_grouping = replace(drug_grouping, drug_grouping=='ine','ite')) %>%
filter(alphavalue < 3.6) %>%
ungroup() %>%
select(nl, Nl_Ranking, drug_grouping) %>%
group_by(nl, Nl_Ranking, drug_grouping) %>%
summarise(n = n()) %>%
arrange(Nl_Ranking, desc(n))
hit_analysis %>%
ungroup() %>%
mutate(nl = factor(hit_analysis$nl, levels = sort(unique(hit_analysis$nl)))) %>%
# pivot_wider(names_from = nl, values_from = n) %>%
ggplot(aes(x = nl, y = Nl_Ranking, fill = n)) +
geom_tile() +
theme_bw() +
theme(axis.text.x = element_text(angle = 45)) +
facet_wrap(~drug_grouping) +
scale_colour_viridis_d()
hit_analysis <- df %>%
mutate(nl =   apply(df[c("n.1.", "n.2.", "n.3.", "n.4.")], 1, paste,collapse="")) %>%
filter(ATOM == 'P') %>%
group_by(drug, compound, alphavalue) %>%
arrange(RMSD_MAP) %>%
slice(1:15) %>%
mutate(Nl_Ranking = row_number()) %>%
mutate(drug_grouping = str_sub(drug,-3,-1)) %>%
mutate(drug_grouping = replace(drug_grouping, drug_grouping=='ide','ate')) %>%
mutate(drug_grouping = replace(drug_grouping, drug_grouping=='ine','ite')) %>%
filter(alphavalue < 3.6) %>%
ungroup() %>%
select(nl, Nl_Ranking, drug_grouping) %>%
group_by(nl, Nl_Ranking, drug_grouping) %>%
summarise(n = n()) %>%
arrange(Nl_Ranking, desc(n))
hit_analysis %>%
ungroup() %>%
mutate(nl = factor(hit_analysis$nl, levels = sort(unique(hit_analysis$nl)))) %>%
# pivot_wider(names_from = nl, values_from = n) %>%
ggplot(aes(x = nl, y = Nl_Ranking, fill = n)) +
geom_tile() +
theme_bw() +
theme(axis.text.x = element_text(angle = 45)) +
facet_wrap(~drug_grouping) +
scale_colour_viridis_d()
hit_analysis <- df %>%
mutate(nl =   apply(df[c("n.1.", "n.2.", "n.3.", "n.4.")], 1, paste,collapse="")) %>%
filter(ATOM == 'P') %>%
group_by(drug, compound, alphavalue) %>%
arrange(RMSD_MAP) %>%
slice(1:5) %>%
mutate(Nl_Ranking = row_number()) %>%
mutate(drug_grouping = str_sub(drug,-3,-1)) %>%
mutate(drug_grouping = replace(drug_grouping, drug_grouping=='ide','ate')) %>%
mutate(drug_grouping = replace(drug_grouping, drug_grouping=='ine','ite')) %>%
filter(alphavalue < 3.6) %>%
ungroup() %>%
select(nl, Nl_Ranking, drug_grouping) %>%
group_by(nl, Nl_Ranking, drug_grouping) %>%
summarise(n = n()) %>%
arrange(Nl_Ranking, desc(n))
hit_analysis %>%
ungroup() %>%
mutate(nl = factor(hit_analysis$nl, levels = sort(unique(hit_analysis$nl)))) %>%
# pivot_wider(names_from = nl, values_from = n) %>%
ggplot(aes(x = nl, y = Nl_Ranking, fill = n)) +
geom_tile() +
theme_bw() +
theme(axis.text.x = element_text(angle = 45)) +
facet_wrap(~drug_grouping) +
scale_colour_viridis_d()
hit_analysis %>%
ungroup() %>%
mutate(nl = factor(hit_analysis$nl, levels = sort(unique(hit_analysis$nl)))) %>%
# pivot_wider(names_from = nl, values_from = n) %>%
ggplot(aes(x = nl, y = Nl_Ranking, fill = n)) +
geom_tile() +
theme_bw() +
theme(axis.text.x = element_text(angle = 45)) +
facet_wrap(~drug_grouping) +
scale_fill_viridis_d()
hit_analysis %>%
ungroup() %>%
mutate(nl = factor(hit_analysis$nl, levels = sort(unique(hit_analysis$nl)))) %>%
# pivot_wider(names_from = nl, values_from = n) %>%
ggplot(aes(x = nl, y = Nl_Ranking, fill = n)) +
geom_tile() +
theme_bw() +
theme(axis.text.x = element_text(angle = 45)) +
facet_wrap(~drug_grouping) +
scale_fill_viridis_c()
hit_analysis <- df %>%
mutate(nl =   apply(df[c("n.1.", "n.2.", "n.3.", "n.4.")], 1, paste,collapse="")) %>%
filter(ATOM == 'P') %>%
group_by(drug, compound, alphavalue) %>%
arrange(RMSD_MAP) %>%
slice(1:50) %>%
mutate(Nl_Ranking = row_number()) %>%
mutate(drug_grouping = str_sub(drug,-3,-1)) %>%
mutate(drug_grouping = replace(drug_grouping, drug_grouping=='ide','ate')) %>%
mutate(drug_grouping = replace(drug_grouping, drug_grouping=='ine','ite')) %>%
filter(alphavalue < 3.6) %>%
ungroup() %>%
select(nl, Nl_Ranking, drug_grouping) %>%
group_by(nl, Nl_Ranking, drug_grouping) %>%
summarise(n = n()) %>%
arrange(Nl_Ranking, desc(n))
hit_analysis %>%
ungroup() %>%
mutate(nl = factor(hit_analysis$nl, levels = sort(unique(hit_analysis$nl)))) %>%
# pivot_wider(names_from = nl, values_from = n) %>%
ggplot(aes(x = nl, y = Nl_Ranking, fill = n)) +
geom_tile() +
theme_bw() +
theme(axis.text.x = element_text(angle = 45)) +
facet_wrap(~drug_grouping) +
scale_fill_viridis_c()
hit_analysis <- df %>%
mutate(nl =   apply(df[c("n.1.", "n.2.", "n.3.", "n.4.")], 1, paste,collapse="")) %>%
filter(ATOM == 'P') %>%
group_by(drug, compound, alphavalue) %>%
arrange(RMSD_MAP) %>%
slice(1:20) %>%
mutate(Nl_Ranking = row_number()) %>%
mutate(drug_grouping = str_sub(drug,-3,-1)) %>%
mutate(drug_grouping = replace(drug_grouping, drug_grouping=='ide','ate')) %>%
mutate(drug_grouping = replace(drug_grouping, drug_grouping=='ine','ite')) %>%
filter(alphavalue < 3.6) %>%
ungroup() %>%
select(nl, Nl_Ranking, drug_grouping) %>%
group_by(nl, Nl_Ranking, drug_grouping) %>%
summarise(n = n()) %>%
arrange(Nl_Ranking, desc(n))
hit_analysis %>%
ungroup() %>%
mutate(nl = factor(hit_analysis$nl, levels = sort(unique(hit_analysis$nl)))) %>%
# pivot_wider(names_from = nl, values_from = n) %>%
ggplot(aes(x = nl, y = Nl_Ranking, fill = n)) +
geom_tile() +
theme_bw() +
theme(axis.text.x = element_text(angle = 45)) +
facet_wrap(~drug_grouping) +
scale_fill_viridis_c()
hit_analysis %>%
ungroup() %>%
mutate(nl = factor(hit_analysis$nl, levels = sort(unique(hit_analysis$nl)))) %>%
# pivot_wider(names_from = nl, values_from = n) %>%
ggplot(aes(x = nl, y = Nl_Ranking, fill = n)) +
geom_tile() +
theme_bw() +
theme(axis.text.x = element_text(angle = 45. cex = 0.5)) +
facet_wrap(~drug_grouping) +
scale_fill_viridis_c()
hit_analysis %>%
ungroup() %>%
mutate(nl = factor(hit_analysis$nl, levels = sort(unique(hit_analysis$nl)))) %>%
# pivot_wider(names_from = nl, values_from = n) %>%
ggplot(aes(x = nl, y = Nl_Ranking, fill = n)) +
geom_tile() +
theme_bw() +
theme(axis.text.x = element_text(angle = 45. size = 0.5)) +
facet_wrap(~drug_grouping) +
scale_fill_viridis_c()
hit_analysis %>%
ungroup() %>%
mutate(nl = factor(hit_analysis$nl, levels = sort(unique(hit_analysis$nl)))) %>%
# pivot_wider(names_from = nl, values_from = n) %>%
ggplot(aes(x = nl, y = Nl_Ranking, fill = n)) +
geom_tile() +
theme_bw() +
theme(axis.text.x = element_text(angle = 45, size = 0.5)) +
facet_wrap(~drug_grouping) +
scale_fill_viridis_c()
hit_analysis %>%
ungroup() %>%
mutate(nl = factor(hit_analysis$nl, levels = sort(unique(hit_analysis$nl)))) %>%
# pivot_wider(names_from = nl, values_from = n) %>%
ggplot(aes(x = nl, y = Nl_Ranking, fill = n)) +
geom_tile() +
theme_bw() +
theme(axis.text.x = element_text(angle = 45, size = 1)) +
facet_wrap(~drug_grouping) +
scale_fill_viridis_c()
hit_analysis %>%
ungroup() %>%
mutate(nl = factor(hit_analysis$nl, levels = sort(unique(hit_analysis$nl)))) %>%
# pivot_wider(names_from = nl, values_from = n) %>%
ggplot(aes(x = nl, y = Nl_Ranking, fill = n)) +
geom_tile() +
theme_bw() +
theme(axis.text.x = element_text(angle = 45, size = 1)) +
facet_wrap(~drug_grouping) +
scale_fill_viridis_c()
hit_analysis %>%
ungroup() %>%
mutate(nl = factor(hit_analysis$nl, levels = sort(unique(hit_analysis$nl)))) %>%
# pivot_wider(names_from = nl, values_from = n) %>%
ggplot(aes(x = nl, y = Nl_Ranking, fill = n)) +
geom_tile() +
theme_bw() +
theme(axis.text.x = element_text(angle = 45, size = 3)) +
facet_wrap(~drug_grouping) +
scale_fill_viridis_c()
hit_analysis %>%
ungroup() %>%
mutate(nl = factor(hit_analysis$nl, levels = sort(unique(hit_analysis$nl)))) %>%
# pivot_wider(names_from = nl, values_from = n) %>%
ggplot(aes(x = nl, y = Nl_Ranking, fill = n)) +
geom_tile() +
theme_bw() +
theme(axis.text.x = element_text(angle = 45, size = 10)) +
facet_wrap(~drug_grouping) +
scale_fill_viridis_c()
hit_analysis %>%
ungroup() %>%
mutate(nl = factor(hit_analysis$nl, levels = sort(unique(hit_analysis$nl)))) %>%
# pivot_wider(names_from = nl, values_from = n) %>%
ggplot(aes(x = nl, y = Nl_Ranking, fill = n)) +
geom_tile() +
theme_bw() +
theme(axis.text.x = element_text(angle = 45, size = 7)) +
facet_wrap(~drug_grouping) +
scale_fill_viridis_c()
hit_analysis %>%
ungroup() %>%
mutate(nl = factor(hit_analysis$nl, levels = sort(unique(hit_analysis$nl)))) %>%
# pivot_wider(names_from = nl, values_from = n) %>%
ggplot(aes(x = nl, y = Nl_Ranking, fill = n)) +
geom_tile() +
theme_bw() +
theme(axis.text.x = element_text(angle = 45, size = 5)) +
facet_wrap(~drug_grouping) +
scale_fill_viridis_c()
hit_analysis %>%
ungroup() %>%
mutate(nl = factor(hit_analysis$nl, levels = sort(unique(hit_analysis$nl)))) %>%
# pivot_wider(names_from = nl, values_from = n) %>%
ggplot(aes(x = nl, y = Nl_Ranking, fill = n)) +
geom_tile() +
theme_bw() +
theme(axis.text.x = element_text(angle = 65, size = 5)) +
facet_wrap(~drug_grouping) +
scale_fill_viridis_c()
hit_analysis %>%
ungroup() %>%
mutate(nl = factor(hit_analysis$nl, levels = sort(unique(hit_analysis$nl)))) %>%
# pivot_wider(names_from = nl, values_from = n) %>%
ggplot(aes(x = nl, y = Nl_Ranking, fill = n)) +
geom_tile() +
theme_bw() +
theme(axis.text.x = element_text(angle = 65, size = 8)) +
facet_wrap(~drug_grouping) +
scale_fill_viridis_c()
hit_analysis %>%
ungroup() %>%
mutate(nl = factor(hit_analysis$nl, levels = sort(unique(hit_analysis$nl)))) %>%
# pivot_wider(names_from = nl, values_from = n) %>%
ggplot(aes(x = nl, y = Nl_Ranking, fill = n)) +
geom_tile() +
theme_bw() +
theme(axis.text.x = element_text(angle = 65, size = 5.5)) +
facet_wrap(~drug_grouping) +
scale_fill_viridis_c()
hit_analysis %>%
ungroup() %>%
mutate(nl = factor(hit_analysis$nl, levels = sort(unique(hit_analysis$nl)))) %>%
# pivot_wider(names_from = nl, values_from = n) %>%
ggplot(aes(x = nl, y = Nl_Ranking, fill = n)) +
geom_tile() +
theme_bw() +
theme(axis.text.x = element_text(angle = 65, size = 6.5)) +
facet_wrap(~drug_grouping) +
scale_fill_viridis_c()
hit_analysis %>%
ungroup() %>%
mutate(nl = factor(hit_analysis$nl, levels = sort(unique(hit_analysis$nl)))) %>%
# pivot_wider(names_from = nl, values_from = n) %>%
ggplot(aes(x = nl, y = Nl_Ranking, fill = n)) +
geom_tile() +
theme_bw() +
theme(axis.text.x = element_text(angle = 65, size = 90, hjust = 1)) +
facet_wrap(~drug_grouping) +
scale_fill_viridis_c()
hit_analysis %>%
ungroup() %>%
mutate(nl = factor(hit_analysis$nl, levels = sort(unique(hit_analysis$nl)))) %>%
# pivot_wider(names_from = nl, values_from = n) %>%
ggplot(aes(x = nl, y = Nl_Ranking, fill = n)) +
geom_tile() +
theme_bw() +
theme(axis.text.x = element_text(angle = 90, size = 6.5, hjust = 1)) +
facet_wrap(~drug_grouping) +
scale_fill_viridis_c()
hit_analysis %>%
ungroup() %>%
mutate(nl = factor(hit_analysis$nl, levels = sort(unique(hit_analysis$nl)))) %>%
# pivot_wider(names_from = nl, values_from = n) %>%
ggplot(aes(x = nl, y = Nl_Ranking, fill = n)) +
geom_tile() +
theme_bw() +
theme(axis.text.x = element_text(angle = 90, size = 6.5, hjust = -1)) +
facet_wrap(~drug_grouping) +
scale_fill_viridis_c()
hit_analysis %>%
ungroup() %>%
mutate(nl = factor(hit_analysis$nl, levels = sort(unique(hit_analysis$nl)))) %>%
# pivot_wider(names_from = nl, values_from = n) %>%
ggplot(aes(x = nl, y = Nl_Ranking, fill = n)) +
geom_tile() +
theme_bw() +
theme(axis.text.x = element_text(angle = 90, size = 6.5, vjust = -1 )) +
facet_wrap(~drug_grouping) +
scale_fill_viridis_c()
hit_analysis %>%
ungroup() %>%
mutate(nl = factor(hit_analysis$nl, levels = sort(unique(hit_analysis$nl)))) %>%
# pivot_wider(names_from = nl, values_from = n) %>%
ggplot(aes(x = nl, y = Nl_Ranking, fill = n)) +
geom_tile() +
theme_bw() +
theme(axis.text.x = element_text(angle = 90, size = 6.5, hjust = -1 )) +
facet_wrap(~drug_grouping) +
scale_fill_viridis_c()
