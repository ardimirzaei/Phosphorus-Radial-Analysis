setwd("D:/People/Bryson/PhosphateAnalysis")
library(corrplot)
library(ggplot2)
library(dplyr)
library(psych) # for describeby
library(car) #for leven's test
library(flextable)
# devtools::install_github("davidgohel/officedown")
library(officedown)
# Filtering for P atom from here.
source('Scripts/Phos_Load_and_Preprocess.R')
source('Scripts/Phos_Alpha_vs_RMSD.R')
library(dplyr)
library(flextable)
df %>%
mutate(nl =   apply(df[c("n.1.", "n.2.", "n.3.", "n.4.")], 1, paste,collapse="")) %>%
filter(ATOM == 'P') %>%
group_by(drug, compound, alphavalue) %>%
arrange(RMSD_MAP) %>%
slice(1:5)
df %>%
mutate(nl =   apply(df[c("n.1.", "n.2.", "n.3.", "n.4.")], 1, paste,collapse="")) %>%
filter(ATOM == 'P') %>%
group_by(drug, compound, alphavalue) %>%
arrange(RMSD_MAP)
df %>%
mutate(nl =   apply(df[c("n.1.", "n.2.", "n.3.", "n.4.")], 1, paste,collapse="")) %>%
filter(ATOM == 'P') %>%
group_by(drug, compound, alphavalue) %>%
arrange(RMSD_MAP) %>%
slice((n()-5):n())
# source('Scripts/Gather_and_zip_files.R')
list.files(pattern = "*bestnl.csv", recursive = TRUE)
df %>%
mutate(nl =   apply(df[c("n.1.", "n.2.", "n.3.", "n.4.")], 1, paste,collapse="")) %>%
filter(ATOM == 'P') %>%
group_by(drug, compound, alphavalue) %>%
arrange(RMSD_MAP) %>%
select(Phosphoroamidate)
df %>%
mutate(nl =   apply(df[c("n.1.", "n.2.", "n.3.", "n.4.")], 1, paste,collapse="")) %>%
filter(ATOM == 'P') %>%
group_by(drug, compound, alphavalue) %>%
arrange(RMSD_MAP) %>%
filter(drug == 'Phosphoroamidate')
df %>%
mutate(nl =   apply(df[c("n.1.", "n.2.", "n.3.", "n.4.")], 1, paste,collapse="")) %>%
filter(ATOM == 'P') %>%
group_by(drug, compound, alphavalue) %>%
arrange(RMSD_MAP) %>%
filter(drug == 'Phosphoroamidate',compound == "Compound_1" )
df %>%
mutate(nl =   apply(df[c("n.1.", "n.2.", "n.3.", "n.4.")], 1, paste,collapse="")) %>%
filter(ATOM == 'P') %>%
group_by(drug, compound, alphavalue) %>%
arrange(RMSD_MAP) %>%
filter(drug == 'Phosphoroamidate',compound == "Compound_1", alphavalue = "3.460" )
df %>%
mutate(nl =   apply(df[c("n.1.", "n.2.", "n.3.", "n.4.")], 1, paste,collapse="")) %>%
filter(ATOM == 'P') %>%
group_by(drug, compound, alphavalue) %>%
arrange(RMSD_MAP) %>%
filter(drug == 'Phosphoroamidate',compound == "Compound_1", alphavalue == "3.460" )
df = read.csv('FileMergeOutput/Full_DataFrame_nl_Atoms.csv')
df %>%
mutate(nl =   apply(df[c("n.1.", "n.2.", "n.3.", "n.4.")], 1, paste,collapse="")) %>%
filter(ATOM == 'P') %>%
group_by(drug, compound, alphavalue) %>%
arrange(RMSD_MAP) %>%
filter(drug == 'Phosphoroamidate',compound == "Compound_1", alphavalue == "3.460" )
df %>%
mutate(nl =   apply(df[c("n.1.", "n.2.", "n.3.", "n.4.")], 1, paste,collapse="")) %>%
filter(ATOM == 'P') %>%
group_by(drug, compound, alphavalue) %>%
arrange(RMSD_MAP) %>%
filter(drug == 'Phosphoroamidate',compound == "Compound_1", alphavalue == "3.4590" )
df %>%
mutate(nl =   apply(df[c("n.1.", "n.2.", "n.3.", "n.4.")], 1, paste,collapse="")) %>%
filter(ATOM == 'P') %>%
group_by(drug, compound, alphavalue) %>%
arrange(RMSD_MAP) %>%
filter(drug == 'Phosphoroamidate',compound == "Compound_1", alphavalue == 3.4590 )
df %>%
mutate(nl =   apply(df[c("n.1.", "n.2.", "n.3.", "n.4.")], 1, paste,collapse="")) %>%
filter(ATOM == 'P') %>%
group_by(drug, compound, alphavalue) %>%
arrange(RMSD_MAP) %>%
filter(drug == 'Phosphoroamidate',compound == "Compound_1" )
df %>%
mutate(nl =   apply(df[c("n.1.", "n.2.", "n.3.", "n.4.")], 1, paste,collapse="")) %>%
filter(ATOM == 'P') %>%
group_by(drug, compound, alphavalue) %>%
arrange(RMSD_MAP) %>%
filter(drug == 'Phosphoroamidate' )
df <- df %>%
rename(Rf.map = `Rf.map...`) %>%
rename(Rf.LSQ = `Rf.LSQ...`) %>%
mutate(nl = apply(df[c("n.1.", "n.2.", "n.3.", "n.4.")], 1, paste,collapse="")) %>%
select(-`Unnamed..10`)
filter(drug == 'Phosphoroamidate' )
df %>%
mutate(nl =   apply(df[c("n.1.", "n.2.", "n.3.", "n.4.")], 1, paste,collapse="")) %>%
# filter(ATOM == 'P') %>%
group_by(drug, compound, alphavalue) %>%
arrange(RMSD_MAP) %>%
filter(drug == 'Phosphoroamidate',compound == "Compound_1", alphavalue == "3.460" )
df %>%
mutate(nl =   apply(df[c("n.1.", "n.2.", "n.3.", "n.4.")], 1, paste,collapse="")) %>%
# filter(ATOM == 'P') %>%
group_by(drug, compound, alphavalue) %>%
arrange(RMSD_MAP) %>%
filter(drug == 'Phosphoroamidate'
)
cat("\n\nCleaning Prefix File Names\n")
df$drug <- gsub("DataFiles\\/","",df$drug)
df$drug <- gsub("DataFiles\\\\","",df$drug)
df$drug <- gsub("MOSS\\\\","",df$drug)
df %>%
mutate(nl =   apply(df[c("n.1.", "n.2.", "n.3.", "n.4.")], 1, paste,collapse="")) %>%
# filter(ATOM == 'P') %>%
group_by(drug, compound, alphavalue) %>%
arrange(RMSD_MAP) %>%
filter(drug == 'Phosphoroamidate'
)
df %>%
mutate(nl =   apply(df[c("n.1.", "n.2.", "n.3.", "n.4.")], 1, paste,collapse="")) %>%
# filter(ATOM == 'P') %>%
group_by(drug, compound, alphavalue) %>%
arrange(RMSD_MAP) %>%
filter(drug == 'Phosphoroamidate',compound == "Compound_1", alphavalue == "3.460" )
df %>%
mutate(nl =   apply(df[c("n.1.", "n.2.", "n.3.", "n.4.")], 1, paste,collapse="")) %>%
# filter(ATOM == 'P') %>%
group_by(drug, compound, alphavalue) %>%
arrange(RMSD_MAP) %>%
filter(drug == 'Phosphoroamidate',compound == "Compound_1", alphavalue == 3.4590 )
df %>%
mutate(nl =   apply(df[c("n.1.", "n.2.", "n.3.", "n.4.")], 1, paste,collapse="")) %>%
filter(ATOM == 'P') %>%
group_by(drug, compound, alphavalue) %>%
arrange(RMSD_MAP) %>%
slice((n()-5):n()) %>%
select(drug, compound, alphavalue, nl, RMSD_MAP) %>%
flextable() %>%
theme_box() %>%
merge_v(j = c('drug', 'compound', 'alphavalue'))
df %>%
mutate(nl =   apply(df[c("n.1.", "n.2.", "n.3.", "n.4.")], 1, paste,collapse="")) %>%
filter(ATOM == 'P') %>%
group_by(drug, compound, alphavalue) %>%
arrange(RMSD_MAP) %>%
filter(drug == 'Phosphoroamidate',compound == "Compound_1", alphavalue == 3.4590 )
df %>%
mutate(nl =   apply(df[c("n.1.", "n.2.", "n.3.", "n.4.")], 1, paste,collapse="")) %>%
filter(ATOM == 'P') %>%
group_by(drug, compound, alphavalue) %>%
arrange(RMSD_MAP) %>%
filter(drug == 'Phosphoroamidate',compound == "Compound_1", alphavalue == 3.4590 ) %>%
View()
df %>%
mutate(nl =   apply(df[c("n.1.", "n.2.", "n.3.", "n.4.")], 1, paste,collapse="")) %>%
filter(ATOM == 'P') %>%
group_by(drug, compound, alphavalue) %>%
arrange(RMSD_MAP) %>%
filter(drug == 'Phosphoroamidate',compound == "Compound_1", alphavalue == 3.4590 ) %>%
slice((n()-5):n())
df %>%
mutate(nl =   apply(df[c("n.1.", "n.2.", "n.3.", "n.4.")], 1, paste,collapse="")) %>%
filter(ATOM == 'P') %>%
group_by(drug, compound, alphavalue) %>%
arrange(RMSD_MAP) %>%
slice((n()-5):n())
df %>%
mutate(nl =   apply(df[c("n.1.", "n.2.", "n.3.", "n.4.")], 1, paste,collapse="")) %>%
filter(ATOM == 'P') %>%
group_by(drug, compound, alphavalue) %>%
arrange(RMSD_MAP) %>%
# filter(drug == 'Phosphoroamidate',compound == "Compound_1", alphavalue == 3.4590 ) %>%
slice((n()-5):n())
df %>%
mutate(nl =   apply(df[c("n.1.", "n.2.", "n.3.", "n.4.")], 1, paste,collapse="")) %>%
filter(ATOM == 'P') %>%
group_by(drug, compound, alphavalue) %>%
arrange(RMSD_MAP) %>%
# filter(drug == 'Phosphoroamidate',compound == "Compound_1", alphavalue == 3.4590 ) %>%
slice(n())
df %>%
mutate(nl =   apply(df[c("n.1.", "n.2.", "n.3.", "n.4.")], 1, paste,collapse="")) %>%
filter(ATOM == 'P') %>%
group_by(drug, compound, alphavalue) %>%
arrange(RMSD_MAP) %>%
# filter(drug == 'Phosphoroamidate',compound == "Compound_1", alphavalue == 3.4590 ) %>%
slice(n()) %>%
View()
df %>%
mutate(nl =   apply(df[c("n.1.", "n.2.", "n.3.", "n.4.")], 1, paste,collapse="")) %>%
filter(ATOM == 'P') %>%
group_by(drug, compound, alphavalue) %>%
arrange(RMSD_MAP) %>%
slice((n()-1):n())
df %>%
mutate(nl =   apply(df[c("n.1.", "n.2.", "n.3.", "n.4.")], 1, paste,collapse="")) %>%
filter(ATOM == 'P') %>%
group_by(drug, compound, alphavalue) %>%
arrange(RMSD_MAP) %>%
# filter(drug == 'Phosphoroamidate',compound == "Compound_1", alphavalue == 3.4590 ) %>%
slice((n()-2):n()) %>%
View()
df %>%
mutate(nl =   apply(df[c("n.1.", "n.2.", "n.3.", "n.4.")], 1, paste,collapse="")) %>%
filter(ATOM == 'P') %>%
group_by(drug, compound, alphavalue) %>%
arrange(RMSD_MAP) %>%
# filter(drug == 'Phosphoroamidate',compound == "Compound_1", alphavalue == 3.4590 ) %>%
slice((n()-2):n())
df %>%
mutate(nl =   apply(df[c("n.1.", "n.2.", "n.3.", "n.4.")], 1, paste,collapse="")) %>%
filter(ATOM == 'P') %>%
group_by(drug, compound, alphavalue) %>%
arrange(RMSD_MAP) %>%
slice((n()-1):n()) %>%
filter(drug == 'Phosphoroamidate',compound == "Compound_1", alphavalue == 3.4590 )
df %>%
mutate(nl =   apply(df[c("n.1.", "n.2.", "n.3.", "n.4.")], 1, paste,collapse="")) %>%
filter(ATOM == 'P') %>%
group_by(drug, compound, alphavalue) %>%
arrange(RMSD_MAP) %>%
slice((n()-1):n()) %>%
filter(drug == 'Phosphoroamidate',compound == "Compound_1", alphavalue == 3.4590 ) %>%
View()
df %>%
mutate(nl =   apply(df[c("n.1.", "n.2.", "n.3.", "n.4.")], 1, paste,collapse="")) %>%
filter(ATOM == 'P') %>%
group_by(drug, compound, alphavalue) %>%
arrange(RMSD_MAP) %>%
slice((n()-1):n()) %>%
slice(1:5) %>%
filter(drug == 'Phosphoroamidate',compound == "Compound_1", alphavalue == 3.4590 ) %>%
View()
df %>%
mutate(nl =   apply(df[c("n.1.", "n.2.", "n.3.", "n.4.")], 1, paste,collapse="")) %>%
filter(ATOM == 'P') %>%
group_by(drug, compound, alphavalue) %>%
arrange(RMSD_MAP) %>%
# slice((n()-1):n()) %>%
slice(1:5) %>%
filter(drug == 'Phosphoroamidate',compound == "Compound_1", alphavalue == 3.4590 ) %>%
View()
df %>%
mutate(nl =   apply(df[c("n.1.", "n.2.", "n.3.", "n.4.")], 1, paste,collapse="")) %>%
filter(ATOM == 'P') %>%
group_by(drug, compound, alphavalue) %>%
arrange(RMSD_MAP) %>%
# slice((n()-1):n()) %>%
slice(1:n()) %>%
filter(drug == 'Phosphoroamidate',compound == "Compound_1", alphavalue == 3.4590 ) %>%
View()
df %>%
mutate(nl =   apply(df[c("n.1.", "n.2.", "n.3.", "n.4.")], 1, paste,collapse="")) %>%
filter(ATOM == 'P') %>%
group_by(drug, compound, alphavalue) %>%
arrange(RMSD_MAP) %>%
# slice((n()-1):n()) %>%
# slice(1:n()) %>%
# filter(drug == 'Phosphoroamidate',compound == "Compound_1", alphavalue == 3.4590 ) %>%
summarise(n = n())
df %>%
mutate(nl =   apply(df[c("n.1.", "n.2.", "n.3.", "n.4.")], 1, paste,collapse="")) %>%
filter(ATOM == 'P') %>%
group_by(drug, compound, alphavalue) %>%
arrange(RMSD_MAP) %>%
# slice((n()-1):n()) %>%
# slice(1:n()) %>%
# filter(drug == 'Phosphoroamidate',compound == "Compound_1", alphavalue == 3.4590 ) %>%
summarise(n = n()) %>%
filter (n<301)
# source('Scripts/Gather_and_zip_files.R')
list.files(pattern = "*bestnl.csv", recursive = TRUE)
# source('Scripts/Gather_and_zip_files.R')
list.files(pattern = "*bestnl.csv", recursive = TRUE) $>$
summarise(n = n()) %>%
filter(n>1)
# source('Scripts/Gather_and_zip_files.R')
list.files(pattern = "*bestnl.csv", recursive = TRUE)%>%
as.data.frame() %>%
summarise(n = n()) %>%
filter(n>1)
# source('Scripts/Gather_and_zip_files.R')
list.files(pattern = "*bestnl.csv", recursive = TRUE)%>%
as.data.frame()
df %>%
mutate(nl =   apply(df[c("n.1.", "n.2.", "n.3.", "n.4.")], 1, paste,collapse="")) %>%
filter(ATOM == 'P') %>%
group_by(drug, compound, alphavalue) %>%
arrange(RMSD_MAP) %>%
# slice((n()-1):n()) %>%
# slice(1:n()) %>%
# filter(drug == 'Phosphoroamidate',compound == "Compound_1", alphavalue == 3.4590 ) %>%
summarise(n = n()) %>%
filter (n<301)
df = read.csv('FileMergeOutput/Full_DataFrame_nl_Atoms.csv')
cat("\n\nCleaning Prefix File Names\n")
df$drug <- gsub("DataFiles\\/","",df$drug)
df$drug <- gsub("DataFiles\\\\","",df$drug)
df$drug <- gsub("MOSS\\\\","",df$drug)
df$drug
uniqe(df$drug)
unique(df$drug)
unique(to_lower(df$drug))
unique(tolower(df$drug))
df$drug <- tolower(df$drug)
unique(df$drug)
proper(unique(df$drug))
toproper(unique(df$drug))
df %>%
mutate(nl =   apply(df[c("n.1.", "n.2.", "n.3.", "n.4.")], 1, paste,collapse="")) %>%
filter(ATOM == 'P') %>%
group_by(drug, compound, alphavalue) %>%
arrange(RMSD_MAP) %>%
# slice((n()-1):n()) %>%
# slice(1:n()) %>%
# filter(drug == 'Phosphoroamidate',compound == "Compound_1", alphavalue == 3.4590 ) %>%
summarise(n = n()) %>%
filter (n<301)
df = read.csv('FileMergeOutput/Full_DataFrame_nl_Atoms.csv')
df %>%
mutate(nl =   apply(df[c("n.1.", "n.2.", "n.3.", "n.4.")], 1, paste,collapse="")) %>%
filter(ATOM == 'P') %>%
group_by(drug, compound, alphavalue) %>%
arrange(RMSD_MAP) %>%
# slice((n()-1):n()) %>%
# slice(1:n()) %>%
# filter(drug == 'Phosphoroamidate',compound == "Compound_1", alphavalue == 3.4590 ) %>%
summarise(n = n())
df %>%
mutate(nl =   apply(df[c("n.1.", "n.2.", "n.3.", "n.4.")], 1, paste,collapse="")) %>%
filter(ATOM == 'P') %>%
group_by(drug, compound, alphavalue) %>%
arrange(RMSD_MAP) %>%
# slice((n()-1):n()) %>%
# slice(1:n()) %>%
# filter(drug == 'Phosphoroamidate',compound == "Compound_1", alphavalue == 3.4590 ) %>%
summarise(n = n()) %>%
filter (n<300)
View()
df %>%
# mutate(nl =   apply(df[c("n.1.", "n.2.", "n.3.", "n.4.")], 1, paste,collapse="")) %>%
filter(ATOM == 'P') %>%
group_by(drug, compound, alphavalue) %>%
arrange(RMSD_MAP) %>%
# slice((n()-1):n()) %>%
# slice(1:n()) %>%
# filter(drug == 'Phosphoroamidate',compound == "Compound_1", alphavalue == 3.4590 ) %>%
summarise(n = n()) %>%
filter (n<300, n > 2)
# Filtering for P atom from here.
source('Scripts/Phos_Load_and_Preprocess.R')
df %>%
# mutate(nl =   apply(df[c("n.1.", "n.2.", "n.3.", "n.4.")], 1, paste,collapse="")) %>%
filter(ATOM == 'P') %>%
group_by(drug, compound, alphavalue) %>%
arrange(RMSD_MAP) %>%
# slice((n()-1):n()) %>%
# slice(1:n()) %>%
# filter(drug == 'Phosphoroamidate',compound == "Compound_1", alphavalue == 3.4590 ) %>%
summarise(n = n())
df %>%
# mutate(nl =   apply(df[c("n.1.", "n.2.", "n.3.", "n.4.")], 1, paste,collapse="")) %>%
filter(ATOM == 'P') %>%
group_by(drug, compound, alphavalue) %>%
arrange(RMSD_MAP) %>%
# slice((n()-1):n()) %>%
# slice(1:n()) %>%
# filter(drug == 'Phosphoroamidate',compound == "Compound_1", alphavalue == 3.4590 ) %>%
summarise(n = n()) %>%
arrange(n)
readLines(".zipit.txt")
readLines(".zipit.txt")
readLines(".zipit")
trimws(readLines(".zipit"))
trimws(readLines(".zipit"))
source('Scripts/Gather_and_zip_files.R')
source('Scripts/Gather_and_zip_files.R')
zip_file_list <- list.files(pattern = paste0('FileMergeOutput/'),recursive = TRUE)
zip(zipfile = paste0('_Archive/File_Outputs_',format(Sys.time(), '%Y%m%d'),'.zip'),, files = zip_file_list)
zip_file_list
zip_file_list <- list.files(pattern = paste0('FileMergeOutput/*'),recursive = TRUE)
zip_file_list
zip_file_list <- list.files(recursive = TRUE)
zip_file_list <- list.files(recursive = TRUE)
zip_file_list
list.files(pattern = paste0('FileMergeOutput/*'),recursive = TRUE)
list.files(pattern = paste0('Analysis/'),recursive = TRUE)
list.files(pattern = paste0('Analysis/*'), recursive = TRUE)
list.files(pattern = paste0('./Analysis/*'), recursive = TRUE)
list.files(pattern = paste0('Analysis/*'), recursive = TRUE)
list.files(pattern = paste0('Analysis\/*'), recursive = TRUE)
list.files(pattern = paste0('Analysis\\/*'), recursive = TRUE)
list.files(pattern = paste0('Analysis'), recursive = TRUE)
list.files(pattern = paste0('Analysis'))
list.files(path = paste0('Analysis'/))
list.files(path = paste0('Analysis'))
zip_file_list <- list.files(path = paste0('FileMergeOutput/'),recursive = TRUE)
zip_file_list
if (trimws(readLines(".zipit"))=="del") delete_files = TRUE
source('Scripts/Gather_and_zip_files.R')
delete_files = FALSE
delete_files = FALSE
if (trimws(readLines(".zipit"))=="del") delete_files = TRUE
source('Scripts/Gather_and_zip_files.R')
zip_file_list <- list.files(path = paste0('FileMergeOutput/'),recursive = TRUE)
zip(zipfile = paste0('_Archive/File_Outputs_',format(Sys.time(), '%Y%m%d'),'.zip'),, files = zip_file_list)
zip_file_list
zip(zipfile = paste0('_Archive/File_Outputs_',format(Sys.time(), '%Y%m%d'),'.zip'), files = zip_file_list)
zip_file_list
zip_file_list <- list.files(path = paste0('FileMergeOutput/'),recursive = TRUE)
zip(zipfile = paste0('_Archive/File_Outputs_',format(Sys.time(), '%Y%m%d'),'.zip'), files = zip_file_list)
zipfile
zip("temp.zip", files = zip_file_list)
list.files()
zip("temp.zip", files = zip_file_list[3])
zip_file_list <- list.files(path = paste0('Analysis/'),recursive = TRUE)
zip(zipfile = paste0('_Archive/Analysis_',format(Sys.time(), '%Y%m%d'),'.zip'), files = zip_file_list)
zip_file_list <- list.files(path = paste0('Analysis/'),recursive = TRUE)
zip(zipfile = paste0('_Archive/Analysis_',format(Sys.time(), '%Y%m%d'),'.zip'), files = zip_file_list)
zip_file_list
paste0('_Archive/Analysis_',format(Sys.time(), '%Y%m%d'),'.zip')
