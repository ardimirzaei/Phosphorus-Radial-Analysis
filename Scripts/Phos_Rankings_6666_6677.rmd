---
title: "Ranking of 6666 + 6677"
author: "ArdiMirzaei"
date: "`r format(Sys.time(), '%d %b %Y')`"
output: officedown::rdocx_document
---

```{r setup, echo =FALSE, results = 'asis', message = FALSE, warning = FALSE}
library(dplyr)
library(flextable)

```

# Location of 6666 and 6677

Tables are filtered for Atom as the phosphate only. 

## Rank 

```{r rank,echo=FALSE,  message = FALSE, warning = FALSE}

ft <- df %>%
  mutate(nl =   apply(df[c("n.1.", "n.2.", "n.3.", "n.4.")], 1, paste,collapse="")) %>%
  filter(ATOM == 'P') %>%
  group_by(drug, compound, alphavalue) %>%
  arrange(RMSD_MAP) %>%
  mutate(rank = min_rank(RMSD_MAP)) %>%
  # slice(1:5) %>%
  filter(nl == '6666' | nl == '6677' ) %>%
  select(drug, compound, alphavalue, nl, rank, RMSD_MAP) %>%
  flextable() %>%
  theme_box() %>%  
  merge_v(j = c('drug', 'compound'))

ft <- set_caption(ft, caption = "Top 5 scoring RMSD MAP ")
ft <- autofit(ft) # fit_to_width(ft, max_width = 15) # autofit(ft)
ft
```